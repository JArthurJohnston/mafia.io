(this["webpackJsonpmafia.io"]=this["webpackJsonpmafia.io"]||[]).push([[0],{11:function(t,e,i){t.exports=i(20)},16:function(t,e,i){},17:function(t,e,i){},20:function(t,e,i){"use strict";i.r(e);var n=i(5),s=i.n(n),a=i(8),o=i.n(a),h=(i(16),i(17),i(0)),r=i(1),c=i(3),l=i(2),u=i(6),d=i(4),f=function(){function t(e,i,n){Object(h.a)(this,t),this.context=e,this.drawCircle=this.drawCircle.bind(this),this.drawRect=this.drawRect.bind(this),this.drawLine=this.drawLine.bind(this),this.rotate=this.rotate.bind(this),this.restore=this.restore.bind(this),this.save=this.save.bind(this),this.translate=this.translate.bind(this),this.windowHeight=n,this.windowWidth=i,this.context.imageSmoothingEnabled=!1}return Object(r.a)(t,[{key:"drawText",value:function(t,e,i,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"30px Arial";this.context.fillStyle=n,this.context.font=s,this.context.fillText(i,t,e)}},{key:"drawCircle",value:function(t,e,i,n){this.context.fillStyle=n,this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.fill(),this.context.stroke()}},{key:"drawLine",value:function(t,e,i,n,s){this.context.strokeStyle=s,this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(i,n),this.context.stroke()}},{key:"rotate",value:function(t){this.context.rotate(t)}},{key:"restore",value:function(){this.context.restore()}},{key:"save",value:function(){this.context.save()}},{key:"translate",value:function(t,e){this.context.translate(t,e)}},{key:"drawRect",value:function(t,e,i,n,s){this.context.fillStyle=s,this.context.beginPath(),this.context.rect(t,e,i,n),this.context.fill(),this.context.stroke()}}]),t}(),v=i(9),p=i.n(v),b={offsetX:function(){return 0},offsetY:function(){return 0}},k=function(){function t(){Object(h.a)(this,t),this.localX=0,this.localY=0,this.parent=b,this.children=[],this.start=this.start.bind(this),this.update=this.update.bind(this),this.render=this.render.bind(this),this.updateLoop=this.updateLoop.bind(this),this.renderLoop=this.renderLoop.bind(this),this.addChild=this.addChild.bind(this),this.offsetX=this.offsetX.bind(this),this.offsetY=this.offsetY.bind(this),this.startLoop=this.startLoop.bind(this),this.removeChild=this.removeChild.bind(this)}return Object(r.a)(t,[{key:"offsetX",value:function(){return this.localX+this.parent.offsetX()}},{key:"offsetY",value:function(){return this.localY+this.parent.offsetY()}},{key:"startLoop",value:function(t){this.start(t),this.children.forEach((function(e){e.startLoop(t)}))}},{key:"updateLoop",value:function(t,e){this.update(t,e),this.children.forEach((function(i){i.updateLoop(t,e)}))}},{key:"renderLoop",value:function(t,e){this.children.forEach((function(i){i.renderLoop(t,e)})),this.render(t,e)}},{key:"addChild",value:function(t){t.parent=this,this.children.push(t)}},{key:"removeChild",value:function(t){p.a.remove(this.children,(function(e){return e===t}))}},{key:"start",value:function(){}},{key:"update",value:function(t){}},{key:"render",value:function(t,e){}}]),t}(),w=function(t){function e(){return Object(h.a)(this,e),Object(c.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(r.a)(e,[{key:"start",value:function(){this.color="black"}},{key:"render",value:function(t){t.drawRect(this.offsetX(),this.offsetY(),t.windowWidth,t.windowHeight,this.color)}}]),e}(k),y=i(10);function m(t){var e={};e.value=t,e.isDown=!1,e.isUp=!0,e.press=void 0,e.release=void 0,e.downHandler=function(t){t.key===e.value&&(e.isUp&&e.press&&e.press(),e.isDown=!0,e.isUp=!1,t.preventDefault())},e.upHandler=function(t){t.key===e.value&&(e.isDown&&e.release&&e.release(),e.isDown=!1,e.isUp=!0,t.preventDefault())};var i=e.downHandler.bind(e),n=e.upHandler.bind(e);return window.addEventListener("keydown",i,!1),window.addEventListener("keyup",n,!1),e.unsubscribe=function(){window.removeEventListener("keydown",i),window.removeEventListener("keyup",n)},e}var j=new(function(){function t(){Object(h.a)(this,t),this.x=0,this.y=0,this.clickHandlers=[],this.init=this.init.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleClick=this.handleClick.bind(this),this.addClickHandler=this.addClickHandler.bind(this)}return Object(r.a)(t,[{key:"init",value:function(){document.onmousemove=this.handleMouseMove}},{key:"handleMouseMove",value:function(t){this.x=t.pageX,this.y=t.pageY}},{key:"handleClick",value:function(t){this.clickHandlers.forEach((function(e){e(t.clientX,t.clientY)}))}},{key:"addClickHandler",value:function(t){this.clickHandlers.push(t)}}]),t}());function O(t,e,i,n){return[n-e,i-t]}var x=function(t){function e(t,i,n,s){var a;return Object(h.a)(this,e),(a=Object(c.a)(this,Object(l.a)(e).call(this))).rise=t,a.run=i,a.startX=n,a.startY=s,a}return Object(d.a)(e,t),Object(r.a)(e,[{key:"start",value:function(){this.speed=20,this.maxDistance=1e3,this.color="white",this.size=6}},{key:"update",value:function(t){var e,i,n,s;this.localX+=this.run*t/10,this.localY+=this.rise*t/10,e=this.offsetX(),i=this.offsetY(),n=this.startX,s=this.startY,Math.sqrt(Math.pow(n-e,2)+Math.pow(s-i,2))>this.maxDistance&&this.parent.removeChild(this)}},{key:"render",value:function(t){t.drawRect(this.offsetX(),this.offsetY(),this.size,this.size,this.color)}}]),e}(k),C=m("w"),g=m("a"),Y=m("s"),X=m("d"),L=function(t){function e(){var t;return Object(h.a)(this,e),(t=Object(c.a)(this,Object(l.a)(e).call(this))).handleKeyboardInput=t.handleKeyboardInput.bind(Object(u.a)(t)),t.handleMouseClick=t.handleMouseClick.bind(Object(u.a)(t)),t}return Object(d.a)(e,t),Object(r.a)(e,[{key:"start",value:function(){this.localX=50,this.localY=50,this.radius=20,this.speed=5,this.color="blue",j.addClickHandler(this.handleMouseClick)}},{key:"render",value:function(t){t.drawCircle(this.offsetX(),this.offsetY(),this.radius,this.color)}},{key:"update",value:function(t){this.handleKeyboardInput(t)}},{key:"handleKeyboardInput",value:function(t){C.isDown&&(this.localY-=this.speed*t),Y.isDown&&(this.localY+=this.speed*t),g.isDown&&(this.localX-=this.speed*t),X.isDown&&(this.localX+=this.speed*t)}},{key:"handleMouseClick",value:function(t,e){var i=O(this.offsetX(),this.offsetY(),t,e),n=Object(y.a)(i,2),s=n[0],a=n[1],o=new x(s,a,this.offsetX(),this.offsetY());o.start(),this.addChild(o)}}]),e}(k);function M(t){return t*Math.PI/180}var D=M(140),E=function(t){function e(){var t;return Object(h.a)(this,e),(t=Object(c.a)(this,Object(l.a)(e).call(this))).fovDistance=1e3,t}return Object(d.a)(e,t),Object(r.a)(e,[{key:"start",value:function(){this.lookX=0,this.lookY=0,this.angle=0,this.color="white"}},{key:"update",value:function(t){var e,i,n,s;this.angle=(e=this.offsetX(),i=this.offsetY(),n=j.x,s=j.y,Math.atan2(n-e,-1*(s-i)))}},{key:"render",value:function(t){t.save(),t.translate(this.offsetX(),this.offsetY()),t.rotate(this.angle-D),t.drawLine(0,0,0,this.fovDistance,this.color),t.drawLine(0,0,this.fovDistance,0,this.color),t.restore()}}]),e}(k),H=function(t){function e(){return Object(h.a)(this,e),Object(c.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(r.a)(e,[{key:"start",value:function(){var t=this;this.localY=25,this.frameCount=0,this.fps=0,this.color="white",setInterval((function(){t.fps=t.frameCount,t.frameCount=0}),1e3)}},{key:"render",value:function(t){this.frameCount++,t.drawText(this.offsetX(),this.offsetY(),"FPS: ".concat(this.fps),this.color)}}]),e}(k);var I=window.innerHeight,T=window.innerWidth,F=function(t){function e(){var t;return Object(h.a)(this,e),(t=Object(c.a)(this,Object(l.a)(e).call(this))).lastFrameTime=0,t.loop=t.loop.bind(Object(u.a)(t)),t.game=function(){var t=new k;t.addChild(new w),t.addChild(new H);var e=new L;return e.addChild(new E),t.addChild(e),t}(),t}return Object(d.a)(e,t),Object(r.a)(e,[{key:"loop",value:function(t){var e=1e3/60/(t-this.lastFrameTime);this.game.updateLoop(e),this.game.renderLoop(this.g,e),this.lastFrameTime=t,requestAnimationFrame(this.loop)}},{key:"componentDidMount",value:function(){this.g=new f(this.refs.canvas.getContext("2d"),T,I),j.init(),this.game.startLoop(this.g),requestAnimationFrame(this.loop)}},{key:"render",value:function(){return s.a.createElement("canvas",{ref:"canvas",width:T,height:I,onClick:j.handleClick})}}]),e}(n.Component);var P=function(){return s.a.createElement("div",{className:"App"},s.a.createElement(F,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[11,1,2]]]);
//# sourceMappingURL=main.931d38b1.chunk.js.map