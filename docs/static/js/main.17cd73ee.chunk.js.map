{"version":3,"sources":["game/engine/Images.js","game/engine/shapes/Line.js","game/engine/math/PointMath.js","GraphicsHelper.js","game/engine/GameObject.js","game/engine/TiledLevelBuilder.js","KeyBinding.js","game/engine/networking/IOHandler.js","game/State.js","game/engine/input/MouseInput.js","game/Explosion.js","game/engine/physics/RayCast.js","game/Bullet.js","game/Level.js","game/Player.js","game/FieldOfVison.js","game/Ammo.js","game/MiniMap.js","game/UIPanels.js","game/OtherPlayers.js","game/ScreenWipe.js","components/Canvas.js","game/index.js","components/LevelEdit.js","components/AvatarEdit.js","components/Routes.js","App.js","serviceWorker.js","index.js","res/sprite-sheet.png"],"names":["spriteSheet","cache","distanceBetween","x1","y1","x2","y2","Math","sqrt","pow","degreesToRadians","angleInDegrees","PI","angleBetween","atan2","SPRITE_WIDTH","SPRITE_HEIGHT","load","imagePath","Promise","resolve","reject","Image","onload","callback","document","createElement","width","height","context","getContext","imageSmoothingEnabled","drawImage","save","translate","restore","rotate","cacheImages","onerror","src","drawStoneFloorOn","x","y","explosionIndeces","ONE_RADIAN","HEIGHT","window","innerHeight","WIDTH","innerWidth","GameScreen","center","GraphicsHelper","canvases","windowWidth","windowHeight","this","layers","layer","setupCanvases","numberOfCanvases","Object","keys","length","i","text","color","font","fillStyle","fillText","layerName","alpha","globalAlpha","shadowValue","shadowColor","shadowBlur","radius","beginPath","arc","fill","stroke","xa","ya","xb","yb","strokeStyle","moveTo","lineTo","clearRect","angle","w","h","rect","size","drawRect","image","drawPlayerOn","drawBulletOn","drawBadgeOn","drawSkullOn","drawAmmoOn","frame","drawExplosionOn","BASE_PARENT","offsetX","offsetY","name","GameObject","localX","localY","parent","children","graphics","start","forEach","child","startLoop","delta","update","updateLoop","render","renderLoop","gameObject","push","_","remove","go","addChild","removeChild","tileFunctions","TILE_SIZE","drawTilesOn","tiles","row","tileIndex","xPosition","yPosition","keyBinding","value","key","isDown","isUp","press","undefined","release","downHandler","event","preventDefault","upHandler","downListener","bind","upListener","addEventListener","unsubscribe","removeEventListener","GameServer","url","updateCallbacks","playerReceived","dispatchUpdates","socket","on","addPlayer","emit","state","player","console","log","bullet","newState","GameState","map","TileSet","direction","ammo","isReloading","getName","otherPlayers","PlayerModel","bullets","xOffset","yOffset","playerPosition","playerMoved","mapTiles","tileSize","offsets","tileAt","floor","xDiff","yDiff","yIndex","xIndex","Tile","index","position","PLAYER_STATES","ALIVE","DEAD","instance","clickHandlers","init","handleMouseMove","handleClick","addClickHandler","onmousemove","pageX","pageY","handler","clientX","clientY","Explosion","frameIndex","frameCount","drawExplosion","bresenhamLine","x0","y0","isSteep","abs","temp","deltaX","deltaY","yStep","points","error","STEP","hitAWall","tile","tileFromScreenSpace","RaycasResult","object","hitAnotherPlayer","eachPlayer","oneEighty","Bullet","id","prevX","prevY","distance","bulletXPos","bulletYPos","Date","now","spawnBullet","maxDistance","speed","explode","centerX","centerY","s","sin","c","cos","rotatePoint","result","startX","startY","endX","endY","wall","simpleRaycast","hit","spawn","destroy","setLayer","drawBullet","wKey","aKey","sKey","dKey","Level","handleMouseClick","cachedBackground","canvas","mapWidth","defaultTiles","mapHeight","screenHeight","screenWidth","cacheLevel","MouseInput","updatePlayerPosition","handleKeyboardInput","xMove","yMove","canMoveVertically","canMoveHorizontally","playerTile","fire","drawBackground","xMovement","yMovement","BYSTANDER","MAFIA","DETECTIVE","Player","midpoint","values","random","drawText","drawPlayer","drawSkull","drawBadge","VIEW_OFFSET","FieldOfVison","fovDistance","lookX","lookY","input","setTransparency","rKey","Ammo","reloadTime","handleReload","drawAmmo","MiniMap","dotSize","renderMiniMap","drawSprite","tileMap","mapImage","PanelHeight","UIPanels","rendered","minViewableAngle","maxViewableAngle","OtherPlayers","playerMap","onPlayerAdded","OtherBullets","Frenemy","addBullet","onBulletFired","otherPlayer","playerUpdated","onUpdate","stateOfTheWorld","updatePosition","originX","originY","p1x","p1y","p2x","p2y","dist1","dist2","dist3","acos","angleFromPoints","distanceToPlayer","visibleToPlayer","ScreenWipe","clear","Canvas","lastFrameTime","loop","game","uiPanels","level","playerScreenWipe","time","deltaTime","requestAnimationFrame","default","refs","defaultCanvas","fov","fovCanvas","players","playerCanvas","ui","uiCanvas","debug","debugCanvas","spritesheet","then","ref","onClick","Component","LevelEdit","images","currentBrush","handlePaint","updateBrush","saveMap","renderTiles","fn","newCanvas","tilesize","className","onclick","indexOf","pallet","appendChild","setState","levelCanvas","offsetLeft","offsetTop","tileWidth","offsetWidth","xCoord","yCoord","style","SIZE","AvatarEdit","backgroundColor","brushColor","bitmap","defaultBitmap","avatarCanvas","drawContext","mozImageSmoothingEnabled","pixelWidth","pixelHeight","offsetHeight","drawAvatar","pixelSize","props","onChangeComplete","hex","fillRect","Routes","path","App","Boolean","location","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister","module","exports"],"mappings":"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KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAChG,CAAC,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,QAG5G,EAAKC,gBA5BQ,E,6EAgCT,IAAK,IAAI/W,EAAI,EAAGA,EAAI,GAAIA,IACpB,IAAK,IAAID,EAAI,EAAGA,EAAI,GAAIA,IACW,OAA5Be,KAAK4G,MAAMoP,OAAO/W,GAAGC,KACpBc,KAAK4G,MAAMoP,OAAO/W,GAAGC,GAAKc,KAAK4G,MAAMkP,mB,0CAMjD9V,KAAKqT,KAAK6C,aAAa/X,MAAQyX,GAC/B5V,KAAKqT,KAAK6C,aAAa9X,OAASwX,GAChC5V,KAAKmW,YAAcnW,KAAKqT,KAAK6C,aAAa5X,WAAW,MACrD0B,KAAKmW,YAAY5X,uBAAwB,EACzCyB,KAAKmW,YAAYC,0BAA2B,EAE5CpW,KAAKqW,WAAarW,KAAKqT,KAAK6C,aAAaV,YAAY,GACrDxV,KAAKsW,YAActW,KAAKqT,KAAK6C,aAAaK,aAAa,GAGvDvW,KAAKwW,e,mCAKL,IADA,IAAMC,EAAYb,GAAO,GAChB1W,EAAI,EAAGA,EAAI,GAAIA,IACpB,IAAK,IAAID,EAAI,EAAGA,EAAI,GAAIA,IACpBqD,GACItC,KAAKmW,YACLlX,EAAIwX,EACJvX,EAAIuX,EACJA,EAAWA,EAAWzW,KAAK4G,MAAMoP,OAAO/W,GAAGC,M,sEASlD,IAAD,OAEJ,OAFI,aACKc,KAAK0W,OAEd,yBAAK5B,UAAU,yBACX,yCACA,yBAAKA,UAAU,kBACX,kBAAC,gBAAD,CACIpU,MAAQV,KAAK4G,MAAMkP,gBACnBa,iBAAmB,SAACjW,GAChB,EAAKyU,SAAS,CAACW,gBAAiBpV,EAAMkW,MACtC,EAAKJ,gBAGb,wCACA,kBAAC,gBAAD,CACI9V,MAAQV,KAAK4G,MAAMmP,WACnBY,iBAAmB,SAACjW,GAAD,OAAW,EAAKyU,SAAS,CAACY,WAAYrV,EAAMkW,UAGvE,4BACI1C,QAASlU,KAAKuU,YACdO,UAAU,gBACVb,IAAI,sB,GA9FKE,cAuGzB,SAAS7R,GAASjE,EAASY,EAAGC,EAAGgD,EAAGC,EAAGzB,GACnCrC,EAAQuC,UAAYF,EACpBrC,EAAQgD,YACRhD,EAAQwY,SAAS5X,EAAGC,EAAGgD,EAAGC,GClHf,SAAS2U,KACpB,OACI,kBAAC,IAAD,KACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAOC,KAAK,gBACR,kBAAC,GAAD,OAEJ,kBAAC,IAAD,CAAOA,KAAK,aACR,kBAAC,GAAD,OAEJ,kBAAC,IAAD,CAAOA,KAAK,KACR,kBAAC,GAAD,SCTLC,OARf,WACE,OACE,yBAAKlC,UAAU,OACb,kBAACgC,GAAD,QCKcG,QACW,cAA7B3X,OAAO4X,SAASC,UAEe,UAA7B7X,OAAO4X,SAASC,UAEhB7X,OAAO4X,SAASC,SAASC,MACvB,2DCZNC,IAASrT,OAAO,kBAAC,GAAD,MAAS/F,SAASqZ,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMzD,MAAK,SAAA0D,GACjCA,EAAaC,iB,iBEnInBC,EAAOC,QAAU,m4I","file":"static/js/main.17cd73ee.chunk.js","sourcesContent":["import { degreesToRadians } from \"./math/PointMath\"\n\nlet spriteSheet, cache\n\nexport const SPRITE_WIDTH = 40\nexport const SPRITE_HEIGHT = 40\n\nexport function load(imagePath){\n  return new Promise((resolve, reject) => {\n    spriteSheet = new Image()\n    spriteSheet.onload = () => cacheImages(spriteSheet, resolve)\n    spriteSheet.onerror = reject\n    spriteSheet.src = imagePath\n  })\n}\n\n/**\n * Caches and scales the spritesheet file\n * \n * @param {Image} spriteSheet \n * @param {function} callback \n */\nfunction cacheImages(spriteSheet, callback) {\n  cache = document.createElement('canvas');\n  cache.width = 460\n  cache.height = 80\n  const context = cache.getContext('2d')\n  context.imageSmoothingEnabled = false\n  // cache the player\n  context.drawImage(spriteSheet, 0,0,20,20, 0,0,40,40)\n\n  // cache the floor\n  context.save()\n  context.translate(40,0)\n  context.drawImage(spriteSheet, 20,0,20,20, 0,0,40,40)\n  context.restore()\n\n  //cache the bullet\n  context.save()\n  context.translate(80, 0)\n  context.drawImage(spriteSheet, 80,0,20,20, 0,0,20,20)\n  context.restore()\n  // cache the horizontal wall\n  context.save()\n  context.translate(100,0)\n  context.drawImage(spriteSheet, 40,0,20,20, 0,0,40,40)\n  context.restore()\n\n  // cache the vertical wall\n  context.save()\n  context.translate(180,0) //need to double the width when rotating, real position is 140\n  context.rotate(degreesToRadians(90))\n  context.drawImage(spriteSheet, 40,0,20,20, 0,0,40,40)\n  context.restore()\n\n  // //cache the angeled wall corners\n\n  context.save()\n  context.translate(180,0)\n  context.drawImage(spriteSheet, 60,0,20,20, 0,0,40,40)\n  context.restore()\n\n  context.save()\n  context.translate(260,0) //actual 220\n  context.rotate(degreesToRadians(90))\n  context.drawImage(spriteSheet, 60,0,20,20, 0,0,40,40)\n  context.restore()\n\n  context.save()\n  context.translate(260,40)\n  context.rotate(degreesToRadians(-90))\n  context.drawImage(spriteSheet, 60,0,20,20, 0,0,40,40)\n  context.restore()\n  \n  context.save()\n  context.translate(340,40)\n  context.rotate(degreesToRadians(180))\n  context.drawImage(spriteSheet, 60,0,20,20, 0,0,40,40)\n  context.restore()\n\n  //cache the skull\n  context.save()\n  context.translate(80,20)\n  context.drawImage(spriteSheet, 0,20,20,20, 0,0,20,20)\n  context.restore()\n\n  //cache the badge\n  context.save()\n  context.translate(340,0)\n  context.drawImage(spriteSheet, 20,20,20,20, 0,0,20,20)\n  context.restore()\n\n  //cache ammo\n  context.save()\n  context.translate(360,0)\n  context.drawImage(spriteSheet, 40,20,20,20, 0,0,40,40)\n  context.restore()\n\n  //cache first explosion frame\n\n  context.save()\n  context.translate(400,0)\n  context.drawImage(spriteSheet, 60,20,20,20, 0,0,20,20)\n  context.restore()\n\n    //cache second explosion frame\n\n    context.save()\n    context.translate(400,20)\n    context.drawImage(spriteSheet, 80,20,20,20, 0,0,20,20)\n    context.restore()\n\n    //cache third explosion frame\n\n    context.save()\n    context.translate(420,0)\n    context.drawImage(spriteSheet, 0,40,20,20, 0,0,20,20)\n    context.restore()\n\n    //cache fourth explosion frame\n\n    context.save()\n    context.translate(420,20)\n    context.drawImage(spriteSheet, 20,40,20,20, 0,0,20,20)\n    context.restore()\n\n    //cache fifth explosion frame\n\n    context.save()\n    context.translate(440,0)\n    context.drawImage(spriteSheet, 40,40,20,20, 0,0,20,20)\n    context.restore()\n\n  callback(cache)\n}\n\nexport function drawPlayerOn(context, x, y) {\n  context.drawImage(cache, 0,0,SPRITE_WIDTH,SPRITE_HEIGHT, x, y,SPRITE_WIDTH,SPRITE_HEIGHT)\n}\n\nexport function drawStoneFloorOn(context, x, y) {\n  context.drawImage(cache, 40,0,40,40, x, y,40,40)\n}\n\nexport function drawBulletOn(context, x, y) {\n  context.drawImage(cache, 80,0,20,20, x, y, 20,20)\n}\n\nexport function drawSkullOn(context, x, y) {\n  context.drawImage(cache, 80,20,20,20, x, y, 20,20)\n}\n\nexport function drawBadgeOn(context, x, y) {\n  context.drawImage(cache, 340,0,20,20, x, y, 20,20)\n}\n\nexport function drawHorizontalWallOn(context, x, y) {\n  context.drawImage(cache, 100,0,40,40, x, y, 40,40)\n}\n\nexport function drawVerticalWallOn(context, x, y) {\n  context.drawImage(cache, 140,0,40,40, x, y, 40,40)\n}\n\nexport function drawAngeled1WallOn(context, x, y) {\n  context.drawImage(cache, 180,0,40,40, x, y, 40,40)\n}\n\nexport function drawAngeled2WallOn(context, x, y) {\n  context.drawImage(cache, 220,0,40,40, x, y, 40,40)\n}\n\nexport function drawAngeled3WallOn(context, x, y) {\n  context.drawImage(cache, 260,0,40,40, x, y, 40,40)\n}\n\nexport function drawAngeled4WallOn(context, x, y) {\n  context.drawImage(cache, 300,0,40,40, x, y, 40,40)\n}\n\nexport function drawAmmoOn(context, x, y) {\n  context.drawImage(cache, 360,0,40,40, x, y, 40,40)\n}\n\nconst explosionIndeces = [\n  {x:400, y:0},\n  {x:400, y:20},\n  {x:420, y:0},\n  {x:420, y:20},\n  {x:440, y:0},\n]\n\nexport function drawExplosionOn(context, x, y, frame){\n  context.drawImage(cache, explosionIndeces[frame].x, explosionIndeces[frame].y, 20, 20,  x, y, 20, 20)\n}\n\nexport function getCache(){\n  return cache\n}\n","import { Point } from \"./Point\";\n\nexport class Line{\n\n  constructor(x1, y1, x2, y2){\n    this.start = new Point(x1, y1)\n    this.end = new Point(x2, y2)\n    this.rotateAround = this.rotateAround.bind(this);\n    this.rotate = this.rotate.bind(this);\n    this.getSlope = this.getSlope.bind(this);\n  }\n\n  rotateAround(centerX, centerY, angle){\n    this.start.rotateAround(centerX, centerY, angle)\n    this.end.rotateAround(centerX, centerY, angle)\n  }\n\n  rotate(angle){\n    this.rotateAround(0,0, angle)\n  }\n\n  getSlope(){\n    return slope(this.start.x, this.start.y, this.end.x, this.end.y)\n  }\n}\n\nexport function distanceBetween(x1,y1, x2,y2){\n  return Math.sqrt(\n    Math.pow(x2-x1, 2) + Math.pow(y2-y1, 2)\n  )\n}\n\nexport function slope(x1, y1, x2, y2){\n  let slopeValues = riseOverRun(x1, y1, x2, y2)\n  return slopeValues[0]/slopeValues[1]\n}\n\nexport function riseOverRun(x1, y1, x2, y2){\n  return [y2 - y1, x2 - x1]\n}\n\nexport function buildLine(x1, y1, slope, distance){\n  let point = findPoint(x1, y1, slope, distance)\n\n  return new Line(x1, y1, point.x, point.y)\n}\n\nexport function unitLengthVector(slope){\n  return Math.sqrt(1 + Math.pow(slope, 2))\n}\n\nexport function findPoint(startX, startY, rise, run, distance){\n  if(rise === 0){\n    return [startX + distance, startY]\n  }\n  if(run===0){\n    return [startX, startY + distance]\n  }\n  let slope  = rise/run\n  let unit = 1 / unitLengthVector(slope)\n\n  let x = (startX + (distance * unit))\n  let y = (startY + slope * distance * unit) * (rise/rise)\n\n  if(run < 0){\n    x *= -1\n    y *= -1\n  }\n\n  return [x, y]\n}\n\nexport function midpointBetween(x1, y1, x2, y2){\n  return [(x1 + x2) / 2, (y1 + y2) / 2]\n}\n\n/**\n * returns the angle, in radians, between 2 lines given the start and end coordinates of each line\n * \n * @param {number} x1a \n * @param {number} y1a \n * @param {number} x2a \n * @param {number} y2a \n * @param {number} x1b \n * @param {number} y1b \n * @param {number} x2b \n * @param {number} y2b \n * \n * @returns {number} the angle in radians\n */\nexport function angleDifference(x1a,y1a, x2a,y2a, x1b,y1b, x2b,y2b){\n  let slopeA = slope(x1a,y1a, x2a,y2a)\n  let slopeB = slope(x1b,y1b, x2b,y2b)\n\n  return Math.atan(\n      (slopeB - slopeA) / (1 + (slopeB * slopeA))\n  )\n}\n\nexport function angle(x1a, y1a, x2a,y2a, x1b,y1b, x2b, y2b){\n  return Math.abs(\n    angleDifference(x1a, y1a, x2a,y2a, x1b,y1b, x2b, y2b)\n  )\n}","import { distanceBetween } from \"../shapes/Line\";\n\nexport function degreesToRadians(angleInDegrees){\n  return angleInDegrees * Math.PI / 180\n}\n\nexport function radiansToDegrees(radians){\n  return radians * 180 / Math.PI\n}\n\nexport function rotatePoint(centerX, centerY, x, y, angle) {\n  const s = Math.sin(angle);\n  const c = Math.cos(angle);\n\n  // translate point back to origin:\n  x -= centerX;\n  y -= centerY;\n\n  const xnew =  x * c + -y * s;\n  const ynew =  x * s + y * c;\n\n  // translate point back:\n  return [xnew + centerX, ynew + centerY]\n}\n\n/**\n * Returns the angle, in radians, between the line made by the 4 coordinate parameters and \n * a vertical line pointing upwards starting at the first coordinates. This angle will be within the range 0 & +-180\n * \n * @param {number} x1 the x coordinate of the first point\n * @param {number} y1 the y coordinate of the first point\n * @param {number} x2 the x coordinate of the second point\n * @param {number} y2 the y coordinate of the second point\n * @returns {number} the angle in radians\n */\nexport function angleBetween(x1, y1, x2, y2){\n  return Math.atan2(x2 - x1, (y2 - y1) * -1 );\n}\n\n/**\n * returns the angle between two lines that meet at the origin point\n * @param {number} originX \n * @param {number} originY \n * @param {number} p1x \n * @param {number} p1y \n * @param {number} p2x \n * @param {number} p2y \n */\nexport function angleFromPoints(originX,originY, p1x,p1y, p2x,p2y){\n  let dist1 = distanceBetween(originX, originY, p1x, p1y)\n  let dist2 = distanceBetween(originX, originY, p2x, p2y)\n  let dist3 = distanceBetween(p1x, p1y, p2x, p2y)\n\n  return Math.acos(((dist1 * dist1) + (dist2 * dist2) - (dist3 * dist3)) / (2 * dist1 * dist2))\n}\n","import { drawStoneFloorOn, drawPlayerOn, drawBulletOn, drawBadgeOn, drawSkullOn, drawAmmoOn, drawExplosionOn } from \"./game/engine/Images\";\n\nconst ONE_RADIAN = 2 * Math.PI;\nconst HEIGHT = window.innerHeight\nconst WIDTH = window.innerWidth\n\nexport const GameScreen = {\n    height: HEIGHT,\n    width: WIDTH,\n    center: {x: WIDTH/2, y:HEIGHT/2},\n}\n\nexport class GraphicsHelper {\n\n    constructor(canvases, windowWidth, windowHeight){   \n        this.layers = canvases\n        this.windowHeight = windowHeight\n        this.windowWidth = windowWidth\n        this.layer = 'default'\n        this.setupCanvases(canvases)\n    }\n\n    setupCanvases(canvases){\n        const numberOfCanvases = Object.keys(canvases).length\n        for (let i = 0; i < numberOfCanvases; i++) {\n            this.getContext(Object.keys(canvases)[i]).imageSmoothingEnabled = false\n        }\n    }\n\n    getContext(){\n        return this.layers[this.layer].getContext(\"2d\")\n    }\n\n    drawText(x, y, text, color = \"white\", font = \"30px Arial\"){\n        this.getContext().fillStyle = color;\n        this.getContext().font = font;\n        this.getContext().fillText(text, x, y);\n    }\n\n    setLayer(layerName){\n        this.layer = layerName\n    }\n\n    setTransparency(alpha){\n        this.getContext().globalAlpha = alpha\n    }\n\n    setShadow(shadowValue, color='rgba(0,0,0,0.5)'){\n        this.getContext().shadowColor = color\n        this.getContext().shadowBlur = shadowValue\n    }\n\n    drawCircle(x, y, radius, color){\n        this.getContext().fillStyle = color;\n        this.getContext().beginPath();\n        this.getContext().arc(x, y, radius, 0, ONE_RADIAN);\n        this.getContext().fill();\n        this.getContext().stroke();\n    }\n\n    drawLine(xa, ya, xb, yb, color=\"cyan\"){\n        this.getContext().strokeStyle = color;\n        this.getContext().beginPath();\n        this.getContext().moveTo(xa, ya);\n        this.getContext().lineTo(xb, yb);\n        this.getContext().stroke(); \n    }\n\n    clear(){\n        this.getContext().clearRect(0,0, WIDTH, HEIGHT)\n    }\n    \n    rotate(angle){\n        this.getContext().rotate(angle)\n    }\n    \n    restore(){\n        this.getContext().restore()\n        this.layer = 'default'\n    }\n\n    save(){\n        this.getContext().save()\n    }\n\n    translate(x, y){\n        this.getContext().translate(x, y)\n    }\n\n    drawRect(x, y, w, h, color){\n        this.getContext().fillStyle = color;\n        this.getContext().beginPath();\n        this.getContext().rect(x, y, w, h)\n        this.getContext().fill();\n    }\n\n    drawSquare(x, y, size, color){\n        this.drawRect(x, y, size, size, color)\n    }\n\n    drawSprite(image, x, y, width, height){\n        this.getContext().drawImage(image, x, y, width, height)\n    }\n\n    drawBackground(image, x = 0, y = 0){\n        this.getContext().drawImage(image, x, y)\n    }\n\n    drawPlayer(x, y){\n        drawPlayerOn(this.getContext(), x, y)\n    }\n\n    drawBullet(x, y){\n        drawBulletOn(this.getContext(), x, y)\n    }\n\n    drawBadge(x, y){\n        drawBadgeOn(this.getContext(), x, y)\n    }\n\n    drawSkull(x, y){\n        drawSkullOn(this.getContext(), x, y)\n    }\n\n    drawAmmo(x, y){\n        drawAmmoOn(this.getContext(), x, y)\n    }\n\n    drawExplosion(x, y, frame){\n        drawExplosionOn(this.getContext(), x, y, frame)\n    }\n}\n\nexport function cacheTiledSprite(rows, columns){\n    const cachCanvas = document.createElement('canvas');\n    cachCanvas.width = 40 * rows\n    cachCanvas.height = 40 * columns\n    const context = cachCanvas.getContext('2d', {alpha: false})\n        for (let row = 0; row < rows; row++) {\n            for (let column = 0; column < columns; column++) {\n                drawStoneFloorOn(context, row * 40, column * 40)\n            }\n        }\n    return cachCanvas\n}\n","import _ from \"lodash\"\n\nconst BASE_PARENT = {\n  offsetX: 0,\n  offsetY: 0,\n  name: 'BASE_PARENT'\n}\n\nexport function spawnAtRoot(gameObject){\n  \n}\n\nexport class GameObject {\n\n  constructor(){\n    this.localX = 0\n    this.localY = 0\n    this.parent = BASE_PARENT;\n    this.children = []\n  }\n\n  get name(){\n    return 'GameObject'\n  }\n \n  /**\n   * This should return the x value of where the object is on the screen\n   * @returns {number} the total x offset of this object and all its parent objects (IE its world position)\n   */\n  get offsetX() {\n    return this.localX + this.parent.offsetX\n  }\n\n  /**\n   * This should return the y value of where the object is on the screen\n   * @returns {number} the total y offset of this object and all its parent objects (IE its world position)\n   */\n  get offsetY() {\n    return this.localY + this.parent.offsetY\n  }\n\n  startLoop(graphics){\n    this.start(graphics)\n    this.children.forEach(child => {\n      child.startLoop(graphics)\n    });\n  }\n\n  updateLoop(delta){\n    this.update(delta)\n    this.children.forEach(child => {\n      child.updateLoop(delta)\n    });\n  }\n\n  renderLoop(graphics, delta){\n    this.render(graphics, delta)\n    this.children.forEach(child => {\n      child.renderLoop(graphics, delta)\n    });\n  }\n\n  addChild(gameObject){\n    gameObject.parent = this\n    this.children.push(gameObject);\n    return this\n  }\n\n  removeChild(gameObject){\n    _.remove(this.children, go => go === gameObject)\n  }\n\n  spawn(gameObject){\n    this.addChild(gameObject)\n    gameObject.start()\n  }\n\n  /**\n   * All this does is remove the game object from the game heirarchy, stopping it from being\n   * updated/rendered every frame.\n   * This does not guarantee the object is ready for garbage collection.\n   * Make sure to clean up any refernces in your object before destroying to \n   * avoid memory leaks.\n   */\n  destroy(){\n    this.parent.removeChild(this)\n  }\n\n  start(){\n\n  }\n\n  /**\n   * Override this method in child objects\n   * @param {number} delta \n   */\n  update(delta){\n\n  }\n\n  /**\n   * Override this method in child objects\n   * @param {GraphicsHelper} graphics The context from the canvas\n   * @param {number} delta \n   */\n  render(graphics, delta) {\n\n  }\n}\n","import { \n  drawHorizontalWallOn, \n  drawVerticalWallOn, \n  drawAngeled1WallOn, \n  drawAngeled2WallOn , \n  drawAngeled3WallOn , \n  drawAngeled4WallOn,  \n  drawStoneFloorOn\n} from \"./Images\";\n\nimport defaultTiles from \"../maps/default2.json\"\n\n/**\n * 0: floor\n * 1: --\n * 2: |\n * 3: -/\n * 4: \\-\n * 5: _\\\n * 6: /_\n */\nexport const tileFunctions = [\n  drawStoneFloorOn,\n  drawHorizontalWallOn,\n  drawVerticalWallOn,\n  drawAngeled1WallOn,\n  drawAngeled2WallOn,\n  drawAngeled3WallOn,\n  drawAngeled4WallOn,\n]\n\nconst TILE_SIZE = 40\n\nexport function cacheLevel() {\n  let canvas = document.createElement('canvas')\n  let context = canvas.getContext('2d', {alpha: false})\n  const mapWidth = defaultTiles[0].length * TILE_SIZE;\n  const mapHeight = defaultTiles.length * TILE_SIZE;\n  const screenHeight = window.innerHeight\n  const screenWidth = window.innerWidth\n\n  canvas.width = mapWidth + screenWidth\n  canvas.height = mapHeight + screenHeight\n\n  context.fillStyle = \"black\";\n  context.beginPath();\n  context.rect(0, 0, canvas.width, canvas.height)\n  context.fill();\n  context.stroke();\n  context.save()\n  drawTilesOn(context, defaultTiles,  screenWidth, screenHeight)\n  return canvas\n}\n\nexport function drawTilesOn(context, tiles, w, h, size=TILE_SIZE){\n  for (let y = 0; y < tiles.length; y++) {\n    const row = tiles[y];\n    for (let x = 0; x < row.length; x++) {\n      const tileIndex = row[x];\n      const xPosition = x * size + w / 2;\n      const yPosition = y * size + h / 2;\n      drawStoneFloorOn(context, xPosition, yPosition)\n      if(tileIndex > 0)\n        tileFunctions[tileIndex](context, xPosition, yPosition)\n    }\n  }\n}\n","export function keyBinding(value) {\n    let key = {};\n    key.value = value;\n    key.isDown = false;\n    key.isUp = true;\n    key.press = undefined;\n    key.release = undefined;\n    //The `downHandler`\n    key.downHandler = event => {\n      if (event.key === key.value) {\n        if (key.isUp && key.press) key.press();\n        key.isDown = true;\n        key.isUp = false;\n        event.preventDefault();\n      }\n    };\n  \n    //The `upHandler`\n    key.upHandler = event => {\n      if (event.key === key.value) {\n        if (key.isDown && key.release) key.release();\n        key.isDown = false;\n        key.isUp = true;\n        event.preventDefault();\n      }\n    };\n  \n    //Attach event listeners\n    const downListener = key.downHandler.bind(key);\n    const upListener = key.upHandler.bind(key);\n    \n    window.addEventListener(\n      \"keydown\", downListener, false\n    );\n    window.addEventListener(\n      \"keyup\", upListener, false\n    );\n    \n    // Detach event listeners\n    key.unsubscribe = () => {\n      window.removeEventListener(\"keydown\", downListener);\n      window.removeEventListener(\"keyup\", upListener);\n    };\n    \n    return key;\n  }","import socket from 'socket.io-client'\nimport state from '../../State'\n\nclass IOHandler {\n\n    init(url){\n        this.updateCallbacks = []\n        this.playerReceived = false\n        this.dispatchUpdates = this.dispatchUpdates.bind(this);\n        this.socket = socket(url)\n        this.socket.on('connected', () => this.addPlayer())\n        this.socket.on('playerReceived', () => this.playerReceived = true)\n        this.socket.on('state_of_the_world', this.dispatchUpdates)\n    }\n\n    addPlayer(){\n        this.socket.emit('playerAdded', {\n            x: state.player.offsetX, \n            y: state.player.offsetY, \n            name: state.player.name\n        })\n    }\n\n    playerMoved(x, y, name){\n        // if(this.playerReceived){\n            this.socket.emit('playerMoved', {\n                x, y, name\n            })\n        // }\n    }\n\n    onPlayerAdded(callback){\n        this.socket.on('frenemyAdded', (player) => {\n            if(player.name !== state.player.name){\n                callback(player)\n            }\n        })\n    }\n\n    onBulletFired(callback){\n        console.log('bullet callback registered');\n        \n        this.socket.on('bulletReceived', (bullet) => {\n            console.log(`new bullet ${bullet}`);\n            \n            callback(bullet)\n        } )\n    }\n\n    dispatchUpdates(newState){\n        for (let i = 0; i < this.updateCallbacks.length; i++) {\n            this.updateCallbacks[i](newState)\n        }\n    }\n    \n    onUpdate(callback){\n        this.updateCallbacks.push(callback)\n    }\n\n    spawnBullet(x, y, angle){\n        this.socket.emit('bulletFired', {x, y, angle})\n    }\n}\n\nconst GameServer = new IOHandler()\nexport default GameServer\n","import mapTiles from \"./maps/default2.json\"\nimport { GameScreen } from \"../GraphicsHelper.js\"\nimport GameServer from \"./engine/networking/IOHandler.js\"\nimport getName from 'node-random-name'\n\nclass GameState {\n\n  constructor(){\n    this.map = new TileSet()\n    this.player = {\n      x: 20,\n      y: 22,\n      offsetX: 0,\n      offsetY:0,\n      direction: 0,\n      ammo: 6,\n      isReloading: false,\n      name: getName(),\n    }\n    this.otherPlayers = [\n      new PlayerModel('RagnarRoog', 1040 + GameScreen.center.x, 1040 + GameScreen.center.y)\n    ]\n    this.bullets = {}\n  }\n\n  updatePlayerPosition(xOffset, yOffset){\n    this.player.offsetX = -xOffset\n    this.player.offsetY = -yOffset\n    let [x, y] = this.map.playerPosition(xOffset, yOffset)\n    this.player.x = x\n    this.player.y = y\n\n    GameServer.playerMoved(this.player.offsetX, this.player.offsetY, this.player.name)\n  }\n}\n\n/**\n * The tileSize property describes each tile's \n * width and height (40 x 40)\n */\nclass TileSet {\n  constructor(){\n    this.tiles = mapTiles\n    this.tileSize = 40\n    this.offsets = {x: 0, y: 0}\n  }\n\n  get width(){\n    return this.tiles[0].length\n  }\n\n  get height(){\n    return this.tiles.length\n  }\n\n  tileAt(x, y){\n    return this.tiles[y][x]\n  }\n\n  playerTile(xOffset, yOffset){\n    const [x, y] = this.playerPosition(xOffset, yOffset)\n    return this.tileAt(x, y)\n  }\n\n  playerPosition(xOffset, yOffset){\n    this.offsets.x = xOffset\n    this.offsets.y = yOffset\n    return [Math.floor(-xOffset / this.tileSize), Math.floor(-yOffset / this.tileSize)]\n  }\n\n  tileFromScreenSpace(x, y){\n    let xDiff = Math.floor((GameScreen.center.x - x) / this.tileSize)\n    let yDiff = Math.floor((GameScreen.center.y - y) / this.tileSize)\n\n    const yIndex = state.player.y - yDiff\n    const xIndex = state.player.x - xDiff\n    if(yIndex < 0 || yIndex > this.height || xIndex < 0 ||xIndex > this.width){\n      return -1\n    }\n    return new Tile(xIndex, yIndex, this.tileAt(xIndex, yIndex))\n  }\n}\n\nclass Tile {\n  constructor(x, y, index){\n    this.index = index\n    this.position = {x, y}\n  }\n\n  hit(){}\n}\n\nexport const PLAYER_STATES = {\n  ALIVE: 'ALIVE',\n  DEAD:'DEAD'\n}\n\nclass PlayerModel {\n  constructor(name, x, y){\n    this.state = PLAYER_STATES.ALIVE\n    this.name = name\n    this.x = x\n    this.y = y\n  }\n\n  hit(){\n    this.state = PLAYER_STATES.DEAD\n  }\n}\n\n//refactor this\nexport const state = new GameState()\n\nexport default state\n\n","class MouseInput {\n\n    constructor(){\n        this.x = 0\n        this.y = 0\n        this.clickHandlers = []\n        this.init = this.init.bind(this)\n        this.handleMouseMove = this.handleMouseMove.bind(this)\n        this.handleClick = this.handleClick.bind(this);\n        this.addClickHandler = this.addClickHandler.bind(this);\n    }\n\n    init(){\n        document.onmousemove = this.handleMouseMove\n    }\n\n    handleMouseMove(event){\n        this.x = event.pageX\n        this.y = event.pageY\n    }\n\n    handleClick(event){\n        this.clickHandlers.forEach(handler => {\n            handler(event.clientX, event.clientY)\n        })\n    }\n\n    addClickHandler(handler){\n        this.clickHandlers.push(handler)\n    }\n}\n\nconst instance = new MouseInput()\n\nexport default instance\n","import { GameObject } from \"./engine/GameObject\";\n\nexport class Explosion extends GameObject {\n\n    constructor(x, y){\n        super()\n        this.localX = x\n        this.localY = y\n        this.frameIndex = 0\n        this.frameCount = 4\n    }\n    \n    get name(){\n        return 'Explosion'\n    }\n\n    update(delta){\n        if(this.frameIndex >= this.frameCount){\n            this.parent.removeChild(this)\n        }\n        this.frameIndex++\n    }\n\n    render(graphics){\n        graphics.save()\n        graphics.translate(Math.floor(this.offsetX - 10), Math.floor(this.offsetY -10))\n        graphics.drawExplosion(0,0, this.frameIndex)\n        graphics.restore()\n    }\n}\n","import { state } from \"../../State\"\nimport { distanceBetween } from \"../shapes/Line\"\n\n/**\n * returns all the points on a line between (x0, y0) and (x1, y1)\n * for better performance you can increase the step (defaults to 1)\n * \n * @param {number} x0 \n * @param {number} y0 \n * @param {number} x1 \n * @param {number} y1 \n */\nexport function bresenhamLine(x0, y0, x1, y1){\n    const isSteep = Math.abs(y1, - y0) > Math.abs(x1, x0)\n\n    if(isSteep){\n        let temp = x0\n        x0 = y0\n        y0 = temp\n\n        temp = x1\n        x1 = y1\n        y1 = temp\n    }\n    if(x0 > x1){\n        let temp = x0\n        x0 = x1\n        x1 = temp\n\n        temp = y0\n        y0 = y1\n        y1 = temp\n    }\n\n    const deltaX = x1 - x0,\n        deltaY = Math.abs(y1 - y0),\n        yStep = (y0 < y1) ? 1 : -1,\n        points = []\n\n    let error = 0, y = y0\n\n    for (let x = x0; x <= x1; x++) {\n        isSteep ? points.push([Math.floor(y), Math.floor(x)]) : points.push([Math.floor(x), Math.floor(y)])\n        error += deltaY\n        if(error * 2 >= deltaX){\n            y += yStep\n            error -= deltaX\n        }\n    }\n\n    return points\n}\n\nconst STEP = 1\n\nexport function raycast(startX, startY, endX, endY){\n    let points = bresenhamLine(startX, startY, endX, endY)\n    if(points[0][0] === startX){\n        for (let i = 0; i < points.length; i += STEP) {\n            const [x, y] = points[i];\n            if(state.map.tileFromScreenSpace(x, y) !== 0)\n                return [x, y]\n        }\n    } else {\n        for (let i = points.length - 1; i >= 0; i -= STEP) {\n            const [x, y] = points[i];\n            if(state.map.tileFromScreenSpace(x, y) !== 0)\n                return [x, y]\n        }\n    }\n}\n\n/**\n * \n * @param {number} startX \n * @param {number} startY \n * @param {number} endX \n * @param {number} endY \n * @returns {Array} the result with the x and y coords of the hit\n */\nexport function simpleRaycast(startX, startY, endX, endY){\n    let points = bresenhamLine(startX, startY, endX, endY)\n    for (let i = 0; i < points.length; i += STEP) {\n        const [x, y] = points[i];\n        const wall = hitAWall(x, y)\n        if(wall !== null){\n            return new RaycasResult(wall, x, y)\n        }\n        const player = hitAnotherPlayer(x, y)\n        if(player !== null){\n            return new RaycasResult(player, x, y)\n        }\n    }\n}\n\nfunction hitAWall(xPosition, yPosition){\n    const tile = state.map.tileFromScreenSpace(xPosition, yPosition)\n    return tile.index !== 0 ? tile : null\n}\n\nclass RaycasResult {\n    constructor(object, x, y){\n        this.object = object\n        this.position = {x, y}\n    }\n}\n\nexport function hitAnotherPlayer(xPosition, yPosition){\n    for (let i = 0; i < state.otherPlayers.length; i++) {\n        const eachPlayer = state.otherPlayers[i];\n\n        let playerX = eachPlayer.x + state.map.offsets.x\n        let playerY = eachPlayer.y + state.map.offsets.y\n        if(distanceBetween(xPosition, yPosition, playerX, playerY) <= 50){\n            return eachPlayer\n        }\n    }\n    return null\n}\n","import { GameObject } from \"./engine/GameObject\";\nimport { degreesToRadians, rotatePoint } from \"./engine/math/PointMath\";\nimport state from './State'\nimport { Explosion } from \"./Explosion\";\nimport { simpleRaycast } from \"./engine/physics/RayCast\";\nimport GameServer from \"./engine/networking/IOHandler\";\nimport { GameScreen } from \"../GraphicsHelper\";\n\nconst oneEighty = degreesToRadians(180)\n\nexport class Bullet extends GameObject {\n\n    static fire(x, y, angle){\n        let bulletXPos = -(x - GameScreen.center.x)\n        let bulletYPos = -(y - GameScreen.center.y)\n        const id = `${state.player.name}:${Date.now}`\n        GameServer.spawnBullet(-x, -y, angle, id)\n        return new Bullet(bulletXPos, bulletYPos, angle, id)\n    }\n\n    constructor(x, y, angle, id){\n        super()\n        this.prevX = x\n        this.prevY = y\n        this.localX = x \n        this.localY = y\n        this.distance = 0\n        this.angle = angle - oneEighty\n        this.id = id\n    }\n\n    get name(){\n        return 'Bullet'\n    }\n\n    start(){\n        state.bullets[this.id] = this\n        this.maxDistance = 1000\n        this.size = 6\n        this.speed = 20\n    }\n\n    update(delta){\n        this.distance += this.speed * delta\n        if((this.distance) > this.maxDistance) {\n            this.explode(this.localX, this.localY)\n            return\n        }\n\n        let [x, y] =  rotatePoint(this.localX, this.localY, this.localX, this.localY + this.speed * delta, this.angle)\n\n        this.prevX = this.offsetX\n        this.prevY = this.offsetY\n\n        this.localX = Math.floor(x)\n        this.localY = Math.floor(y)\n\n        let result = simpleRaycast(this.prevX, this.prevY, this.offsetX, this.offsetY)\n\n        if(result){\n            result.object.hit()\n            this.explode(this.localX, this.localY)\n        }\n    }\n\n    explode(x, y){\n        delete state.bullets[this.id]\n        this.parent.spawn(new Explosion(x, y))\n        this.destroy()\n    }\n\n    render(graphics){\n        graphics.setLayer('players')\n        graphics.save()\n        graphics.translate(this.offsetX, this.offsetY)\n        graphics.rotate(this.angle + oneEighty)\n        graphics.drawBullet(0, 0)\n        graphics.restore()\n    }\n}\n","import { GameObject } from \"./engine/GameObject\";\nimport { cacheLevel } from \"./engine/TiledLevelBuilder\";\nimport { keyBinding } from \"../KeyBinding\";\nimport { state } from './State'\nimport MouseInput from \"./engine/input/MouseInput\"\nimport { Bullet } from \"./Bullet\";\nimport { GameScreen } from \"../GraphicsHelper\";\nimport { angleBetween } from \"./engine/math/PointMath\";\n\nconst wKey = keyBinding(\"w\")\nconst aKey = keyBinding(\"a\")\nconst sKey = keyBinding(\"s\")\nconst dKey = keyBinding(\"d\")\n\nexport class Level extends GameObject {\n\n  constructor(){\n    super()\n    this.handleMouseClick = this.handleMouseClick.bind(this);\n  }\n\n  get name(){\n    return 'Level'\n  }\n\n  start(){\n    this.speed = 5\n    this.cachedBackground = cacheLevel()\n    MouseInput.addClickHandler(this.handleMouseClick)\n    this.localX = -state.player.x * state.map.tileSize\n    this.localY = -state.player.y * state.map.tileSize\n    state.updatePlayerPosition(this.localX, this.localY)\n  }\n\n  update(delta){\n    let [xMove, yMove] = this.handleKeyboardInput(delta)\n\n    if(xMove !== 0 || yMove !== 0){\n      if(this.canMoveVertically(yMove))\n        this.localY += Math.floor(yMove)\n      if(this.canMoveHorizontally(xMove))\n        this.localX += Math.floor(xMove)\n      state.updatePlayerPosition(this.localX, this.localY)\n    }\n  }\n\n  canMoveVertically(yMove){\n    return state.map.playerTile(this.offsetX, this.offsetY + yMove) === 0 //&&\n  }\n\n  canMoveHorizontally(xMove){\n    return state.map.playerTile(this.offsetX + xMove, this.offsetY) === 0 //&&\n  }\n\n  handleMouseClick(x, y){\n    if(state.player.ammo > 0 && !state.player.isReloading){\n      state.player.ammo -= 1\n      let angle = angleBetween(GameScreen.center.x, GameScreen.center.y , x, y)\n      this.spawn(Bullet.fire(this.offsetX, this.offsetY, angle))\n    }\n  }\n\n  render(graphics){\n    graphics.drawBackground(this.cachedBackground, this.offsetX, this.offsetY)\n  }\n\n  handleKeyboardInput(delta){\n    let xMovement = 0, yMovement = 0\n    if(wKey.isDown){\n        yMovement += this.speed * delta\n    }\n    if(sKey.isDown){\n        yMovement -= this.speed * delta\n    }\n    if(aKey.isDown){\n        xMovement += this.speed * delta\n    }\n    if(dKey.isDown){\n        xMovement -= this.speed * delta\n    }\n    return [xMovement, yMovement]\n  }\n}\n","import { GameObject } from \"./engine/GameObject\";\nimport { GameScreen } from \"../GraphicsHelper\";\nimport state from \"./State\";\n\nexport const PLAYER_STATES = {\n  BYSTANDER: 'BYSTANDER',\n  MAFIA: 'MAFIA',\n  DETECTIVE: 'DETECTIVE',\n}\n\nexport default class Player extends GameObject {\n\n  constructor(){\n    super()\n    this.width = 40\n    this.midpoint = this.width/2\n    this.state = PLAYER_STATES.BYSTANDER\n  }\n\n  get name(){\n    return 'Player'\n  }\n\n  start(){\n    this.state = Object.values(PLAYER_STATES)[Math.floor(Math.random() * 3)]\n    this.localX = GameScreen.center.x\n    this.localY = GameScreen.center.y\n  }\n\n  render(graphics){\n    graphics.setLayer('players')\n    graphics.drawText(this.offsetX - 50, this.offsetY - 25, state.player.name, \"cyan\", '15px arial')\n    graphics.drawPlayer(Math.floor(this.offsetX - this.midpoint), Math.floor(this.offsetY - this.midpoint))\n    if(this.state === PLAYER_STATES.MAFIA)\n      graphics.drawSkull(Math.floor(this.offsetX + 10), Math.floor(this.offsetY + 10))\n    if(this.state === PLAYER_STATES.DETECTIVE)\n      graphics.drawBadge(Math.floor(this.offsetX + 10), Math.floor(this.offsetY + 10))\n    graphics.restore()\n  }\n}\n","import { GameObject } from \"./engine/GameObject\";\nimport { angleBetween, degreesToRadians } from \"./engine/math/PointMath\";\nimport input from './engine/input/MouseInput'\nimport {state} from \"./State\"\nimport { GameScreen } from \"../GraphicsHelper\";\n\nconst VIEW_OFFSET = degreesToRadians(134)\n\nexport class FieldOfVison extends GameObject {\n\n  constructor(){\n    super()\n    this.fovDistance = 1000\n  }\n\n  get name(){\n    return 'FieldOfVison'\n  }\n\n  start(){\n    this.localX = GameScreen.center.x\n    this.localY = GameScreen.center.y\n    this.lookX = 0\n    this.lookY = 0\n    this.angle = 0\n  }\n\n  update(delta){\n    this.angle = angleBetween(this.offsetX, this.offsetY, input.x, input.y)\n    state.player.direction = this.angle\n  }\n\n  /*\n  I should try prerendering the rectangles that make up the blinders. then draw every\n  other pixel in them to create a transparent effect. then draw that as an image.\n  or I could make a transparent blinder sprite and just import and use that.\n  */\n\n  render(graphics){    \n    // graphics.save()\n    // graphics.setLayer('fov')\n    graphics.save()\n    graphics.translate(this.offsetX, this.offsetY)\n    graphics.setTransparency(0.8)\n    // graphics.setShadow(40)\n    graphics.rotate(this.angle - VIEW_OFFSET)\n    graphics.drawRect(-graphics.windowWidth, Math.floor(-(graphics.windowWidth * 1.5)/2), graphics.windowWidth, Math.floor(graphics.windowWidth * 1.5), \"black\")\n    graphics.drawRect(-0, -graphics.windowWidth, graphics.windowWidth, graphics.windowWidth, \"black\")\n    graphics.restore()\n  }\n}","import { GameObject } from \"./engine/GameObject\";\nimport { keyBinding } from \"../KeyBinding\";\nimport { GameScreen } from \"../GraphicsHelper\";\nimport state from \"./State\";\n\nconst rKey = keyBinding(\"r\")\n\nconst RELOAD_INTERVAL = 25\n\nexport class Ammo extends GameObject {\n\n    start(){\n        this.localY = GameScreen.height - 75\n        this.localX = 25\n        this.reloadTime = 0\n    }\n    \n    update(delta){\n        if(rKey.isDown){\n            state.player.isReloading = true\n        }\n        this.handleReload(delta)\n    }\n\n    handleReload(delta){\n        if(state.player.isReloading){\n            if(state.player.ammo < 6){\n                if(this.reloadTime >= RELOAD_INTERVAL){\n                    state.player.ammo += 1\n                    this.reloadTime = 0\n                }\n                this.reloadTime += delta\n            } else {\n                state.player.isReloading = false\n            }\n        }\n    }\n\n    render(graphics){\n        graphics.setLayer('ui')\n        graphics.setTransparency(0.15)\n        graphics.drawRect(this.offsetX, this.offsetY, 6 * 32, 40, \"black\")\n        graphics.setTransparency(1)\n        for (let i = 0; i < state.player.ammo; i++) {\n            graphics.drawAmmo(this.offsetX + i * 30, this.offsetY)\n        }\n        graphics.restore()\n    }\n}\n","import { GameObject } from \"./engine/GameObject\";\nimport state from \"./State\";\nimport { GameScreen } from \"../GraphicsHelper\";\n\nexport class MiniMap extends GameObject {\n\n    constructor(){\n        super()\n        this.dotSize = 2\n    }\n\n    get name(){\n        return 'MiniMap'\n    }\n\n    start(){\n        this.image = this.renderMiniMap()\n        this.localX = GameScreen.width - 125\n        this.localY = GameScreen.height - 125\n    }\n\n    render(graphics){\n        graphics.setLayer('ui')\n        graphics.save()\n        graphics.translate(this.offsetX, this.offsetY)\n        graphics.drawSprite(this.image, 0,0, this.image.width, this.image.height)\n        graphics.drawRect(\n            this.dotSize * state.player.x,\n            this.dotSize * state.player.y,\n            4, 4,\n            \"magenta\"\n        )\n        graphics.restore()\n    }\n\n    renderMiniMap(){\n        const tileMap = state.map\n        const mapImage = document.createElement('canvas')\n        mapImage.width = tileMap.width * this.dotSize\n        mapImage.height = tileMap.height * this.dotSize\n        const context = mapImage.getContext('2d')\n        for (let y = 0; y < tileMap.height; y++) {\n            for (let x = 0; x < tileMap.width; x++) {\n                if(tileMap.tileAt(x, y) === 0){\n                    drawRect(context, x * this.dotSize, y * this.dotSize, this.dotSize, this.dotSize, \"black\")\n                } else {\n                    drawRect(context, x * this.dotSize, y * this.dotSize, this.dotSize, this.dotSize, \"green\")\n                }\n            }\n        }\n        return mapImage\n    }\n}\n\nfunction drawRect(context, x, y, w, h, color) {\n    context.fillStyle = color;\n    context.beginPath();\n    context.rect(x, y, w, h)\n    context.fill();\n}","import { GameObject } from \"./engine/GameObject\";\nimport { GameScreen } from \"../GraphicsHelper\";\n\nconst PanelHeight = Math.floor(GameScreen.height * 0.15);\n\nexport class UIPanels extends GameObject {\n\n    start(){\n        this.rendered = false\n    }\n\n    render(graphics){\n        if(!this.rendered){\n            graphics.setLayer('ui')\n            graphics.drawRect(0,0, GameScreen.width, PanelHeight, \"black\")\n            graphics.drawRect(0,GameScreen.height - PanelHeight, GameScreen.width, PanelHeight, \"black\")\n            graphics.restore()\n            this.rendered = true\n        }\n    }\n}","import { GameObject } from \"./engine/GameObject\";\nimport state, { PLAYER_STATES } from \"./State\";\nimport { degreesToRadians, angleFromPoints } from \"./engine/math/PointMath\";\nimport { GameScreen } from \"../GraphicsHelper\";\nimport input from './engine/input/MouseInput'\nimport { distanceBetween } from \"./engine/shapes/Line\";\nimport GameServer from \"./engine/networking/IOHandler\";\nimport { Bullet } from \"./Bullet\";\n\nconst minViewableAngle = degreesToRadians(-45)\nconst maxViewableAngle = degreesToRadians(45)\n\nexport default class OtherPlayers extends GameObject {\n\n    constructor(){\n        super()\n        this.playerMap = {}\n        this.addPlayer = this.addPlayer.bind(this);\n        GameServer.onPlayerAdded(this.addPlayer)\n        this.localX = GameScreen.center.x\n        this.localY = GameScreen.center.y\n    }\n\n    start(){\n        this.spawn(new OtherBullets())\n    }\n\n    addPlayer(player){\n        this.spawn(new Frenemy(player))\n    }\n\n    name(){\n        return 'OtherPlayers'\n    }\n}\n\nclass OtherBullets extends GameObject {\n\n    constructor(){\n        super()\n        this.addBullet = this.addBullet.bind(this);\n    }\n\n    start(){\n        GameServer.onBulletFired(this.addBullet)\n    }\n\n    addBullet({x, y, id, angle}){\n        if(!state.bullets[id])\n            this.spawn(new Bullet(x, y, angle, id))\n    }\n}\n\nclass Frenemy extends GameObject {\n\n    constructor(otherPlayer){\n        super()\n        this.player = otherPlayer\n        this.playerUpdated = this.playerUpdated.bind(this);\n        GameServer.onUpdate(this.playerUpdated)\n    }\n\n    name(){\n        return 'Frenemy'\n    }\n\n    playerUpdated(stateOfTheWorld){\n        // console.log(JSON.stringify(stateOfTheWorld));\n        \n        const player = stateOfTheWorld.playerMap[this.player.name]\n        this.player = player\n        this.localX = player.x //+ state.map.offsets.x\n        this.localY = player.y //+ state.map.offsets.y\n    }\n\n    updatePosition(){\n        /*\n        the state.map.offsets will always be negative, \n        these will be parented to the player\n        */\n        this.localX = this.player.x //+ state.map.offsets.x\n        this.localY = this.player.y //+ state.map.offsets.y\n    }\n\n    start(){\n        this.updatePosition()\n    }\n\n    get color(){\n        return this.player.state === PLAYER_STATES.ALIVE ? \"cyan\" : \"white\"\n    }\n\n    visibleToPlayer(){\n        let angle = angleFromPoints(GameScreen.center.x, GameScreen.center.y, this.offsetX, this.offsetY, input.x, input.y)\n        const distanceToPlayer = distanceBetween(this.offsetX, this.offsetY, GameScreen.center.x, GameScreen.center.y)\n        return (angle > minViewableAngle && angle < maxViewableAngle) || distanceToPlayer <= 70\n    }\n    \n    render(graphics){\n        if(this.visibleToPlayer()){\n            graphics.setLayer('players')\n            graphics.drawText(this.offsetX - 50, this.offsetY - 25, this.player.name, \"red\", '15px arial')\n            graphics.drawRect(this.offsetX - 20, this.offsetY - 20, 40, 40, this.color)\n            graphics.restore()\n        }\n    }\n}\n","import { GameObject } from \"./engine/GameObject\";\n\nexport class ScreenWipe extends GameObject {\n\n    constructor(){\n        super()\n        this.layer = 'default'\n    }\n\n    render(graphics){\n        graphics.setLayer(this.layer)\n        graphics.clear()\n        graphics.restore()\n    }\n}","import React, {Component} from 'react'\nimport { GraphicsHelper, GameScreen } from '../GraphicsHelper'\nimport { init } from '../game'\nimport MouseInput from '../game/engine/input/MouseInput'\nimport GameServer from '../game/engine/networking/IOHandler'\nimport { load } from '../game/engine/Images'\nimport spritesheet from \"../res/sprite-sheet.png\"\n\nconst FRAME_INTERVAL = 1000 / 30 //30 fps\n\nexport class Canvas extends Component {\n\n    constructor(){\n        super()\n        this.lastFrameTime = 0\n        this.loop = this.loop.bind(this);\n        GameServer.init('http://localhost:3001')\n        this.game = init()\n    }\n\n    loop(time){\n        const elapsedFrameTime = time - this.lastFrameTime;\n        const deltaTime = FRAME_INTERVAL / elapsedFrameTime;\n        this.game.updateLoop(deltaTime)\n        this.game.renderLoop(this.graphics, deltaTime)\n        this.lastFrameTime = time\n        requestAnimationFrame(this.loop); \n    }\n\n    componentDidMount(){\n        let canvases = {\n            default: this.refs.defaultCanvas, \n            fov: this.refs.fovCanvas,\n            players: this.refs.playerCanvas,\n            ui: this.refs.uiCanvas,\n            debug: this.refs.debugCanvas,\n        }\n        this.refs.debugCanvas.addEventListener('contextmenu', event => event.preventDefault())\n        this.graphics = new GraphicsHelper(canvases, GameScreen.width, GameScreen.height)\n        this.graphics.drawText(GameScreen.width/2, GameScreen.height/2, \"LOADING...\", \"white\")\n        MouseInput.init()\n        \n        load(spritesheet).then(() => {\n            this.game.startLoop(this.graphics)\n            requestAnimationFrame(this.loop);\n        })\n    }\n\n    render() { \n        return (\n            <>\n                <canvas ref=\"defaultCanvas\" width={GameScreen.width} height={GameScreen.height}></canvas>\n                <canvas ref=\"fovCanvas\" width={GameScreen.width} height={GameScreen.height}></canvas>\n                <canvas ref=\"playerCanvas\" width={GameScreen.width} height={GameScreen.height}></canvas>\n                <canvas ref=\"uiCanvas\" width={GameScreen.width} height={GameScreen.height}></canvas>\n                <canvas ref=\"debugCanvas\" width={GameScreen.width} height={GameScreen.height} onClick={MouseInput.handleClick}></canvas>\n                {/* <div \n                    ref='screenInput' \n                    style={{width: '100vw', height: '100vh'}} \n                    onClick={() => {\n                        alert('clicked')\n                        // MouseInput.handleClick()\n                    }}\n                /> */}\n            </>\n        )\n    }\n}\n","import { GameObject } from \"./engine/GameObject\";\nimport { Level } from \"./Level\";\nimport Player from \"./Player\";\nimport { FieldOfVison } from \"./FieldOfVison\";\nimport { FPSView } from \"./debugging/FPSView\";\nimport { Ammo } from \"./Ammo\";\nimport { MiniMap } from \"./MiniMap\";\nimport { UIPanels } from \"./UIPanels\";\n\n// import { CacheView } from \"./engine/debug/CacheView\";\n// import { getCache } from \"./engine/Images\";\nimport OtherPlayers from \"./OtherPlayers\";\nimport { ScreenWipe } from \"./ScreenWipe\";\nimport { ScreenInfoView } from \"./debugging/ScreenInfoView\";\nimport MousePosition from \"./debugging/MousePosition\";\n\nexport function init(){\n  const debugScreenWipe = new ScreenWipe()\n  debugScreenWipe.layer = 'debug'\n\n  // const debugTools =\n  //   new GameObject()\n  //     .addChild(debugScreenWipe)\n  //     .addChild(new FPSView())\n  //     .addChild(new ScreenInfoView())\n  //     .addChild(new MousePosition())\n  \n  const uiPanels = \n    new UIPanels()\n      .addChild(new Ammo())\n      .addChild(new MiniMap())\n          \n  const level = \n    new Level()\n      .addChild(new OtherPlayers())\n      \n  const playerScreenWipe = new ScreenWipe()\n  playerScreenWipe.layer = 'players'\n\n  const root = \n    new GameObject()    \n      // .addChild(debugTools)\n      .addChild(playerScreenWipe)\n      .addChild(level)\n      .addChild(new Player())\n      .addChild(new FieldOfVison())\n      .addChild(uiPanels)\n  //    .addChild(new CacheView(getCache()))\n  return root\n}\n","import React, {Component} from \"react\"\nimport { drawTilesOn, tileFunctions } from \"../game/engine/TiledLevelBuilder\";\nimport { load } from \"../game/engine/Images\";\nimport spritesheet from \"../res/sprite-sheet.png\"\nimport './styles/LevelEdit.scss'\nimport defaultTiles from \"../game/maps/default2.json\"\nimport {state} from \"../game/State\"\n\nconst CANVAS_WIDTH = 52*40\nconst CANVAS_HEIGHT = 52*40\n\nexport default class LevelEdit extends Component {\n    constructor(){\n        super()\n        this.state = {\n            tiles: defaultTiles,\n            images: [],\n            currentBrush: 1\n        }\n        this.handlePaint = this.handlePaint.bind(this);\n        this.updateBrush = this.updateBrush.bind(this);\n        this.saveMap = this.saveMap.bind(this);\n    }\n\n    componentDidMount(){\n        load(spritesheet).then(() => {\n            this.renderTiles()\n\n            tileFunctions.forEach(fn => {\n                const newCanvas = document.createElement('canvas');\n                newCanvas.width=state.map.tileSize\n                newCanvas.height=state.map.tilesize\n                newCanvas.className='brush'\n                newCanvas.onclick = () => {this.updateBrush(tileFunctions.indexOf(fn))}\n                fn(newCanvas.getContext('2d'), 0, 0)\n                this.refs.pallet.appendChild(newCanvas)\n            })\n        })\n    }\n\n    updateBrush(index){\n        this.setState({...this.state, currentBrush: index})\n    }\n\n    renderTiles(){\n        const canvas = this.refs.levelCanvas;\n        drawTilesOn(canvas.getContext(\"2d\"), this.state.tiles, 0, 0)\n    }\n\n    componentDidUpdate(){\n        this.renderTiles()\n    }\n\n    handlePaint({pageX, pageY}){\n        const {offsetLeft, offsetTop, offsetWidth} = this.refs.levelCanvas;\n        const tileWidth = offsetWidth / 52\n        const xCoord = Math.floor([(pageX - offsetLeft) / tileWidth]);\n        const yCoord = Math.floor([(pageY - offsetTop) / tileWidth]);\n        let tiles = [...this.state.tiles]\n        tiles[yCoord][xCoord] = this.state.currentBrush\n        this.setState({tiles})\n    }\n\n    saveMap(){\n        console.log(this.state.tiles)\n    }\n\n    render(){\n        return(\n            <div className='level-edit-container'>\n            <div ref='pallet' className='pallet'></div>\n                <canvas \n                    onClick={this.handlePaint}\n                    className='level-canvas' \n                    style={{position: 'relative'}} \n                    ref=\"levelCanvas\" width={CANVAS_WIDTH} height={CANVAS_HEIGHT}\n                />\n                <button onClick={this.saveMap}>Save</button>\n            </div>\n        )\n    }\n}\n\n","import React, {Component} from \"react\"\nimport { SketchPicker } from 'react-color';\nimport './styles/AvatarEdit.scss'\nimport './styles/ColorPallet.scss'\n\nconst SIZE = Math.floor(window.innerHeight / 2)\n\nclass ColorPallet extends Component {\n    render(){\n        let {} = this.props;\n        return(\n            <div className='color-pallet'>\n                <SketchPicker />\n            </div>\n        )\n    }\n}\n\nclass AvatarEdit extends Component {\n    constructor(){\n        super()\n        this.state = {\n            backgroundColor: '#B8E986',\n            brushColor: '#000',\n            bitmap: [\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,'#000',null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n                [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\n            ]\n        }\n    this.defaultBitmap()\n    }\n\n    defaultBitmap(){\n        for (let y = 0; y < 20; y++) {\n            for (let x = 0; x < 20; x++) {\n                if(this.state.bitmap[x][y] === null)\n                    this.state.bitmap[x][y] = this.state.backgroundColor\n            }\n        }\n    }\n\n    componentDidMount(){\n        this.refs.avatarCanvas.width = SIZE\n        this.refs.avatarCanvas.height = SIZE\n        this.drawContext = this.refs.avatarCanvas.getContext('2d')\n        this.drawContext.imageSmoothingEnabled = false\n        this.drawContext.mozImageSmoothingEnabled = false;\n\n        this.pixelWidth = this.refs.avatarCanvas.offsetWidth/20\n        this.pixelHeight = this.refs.avatarCanvas.offsetHeight/20\n\n\n        this.drawAvatar()\n    }\n\n    drawAvatar(){\n        const pixelSize = SIZE / 20\n        for (let y = 0; y < 20; y++) {\n            for (let x = 0; x < 20; x++) {\n                drawRect(\n                    this.drawContext, \n                    x * pixelSize, \n                    y * pixelSize, \n                    pixelSize, pixelSize, this.state.bitmap[x][y])\n            }\n        }\n    }\n\n    handlePaint(){\n\n    }\n\n    render(){\n        let {} = this.props;\n        return(\n        <div className='avatar-edit-container'>\n            <p>Background</p>\n            <div className='paint-controls'>\n                <SketchPicker \n                    color={ this.state.backgroundColor }\n                    onChangeComplete={ (color) => {\n                        this.setState({backgroundColor: color.hex})\n                        this.drawAvatar()\n                    }}\n                />\n                <label>Brush</label>\n                <SketchPicker \n                    color={ this.state.brushColor }\n                    onChangeComplete={ (color) => this.setState({brushColor: color.hex}) }\n                />\n            </div>\n            <canvas \n                onClick={this.handlePaint}\n                className='avatar-canvas' \n                ref=\"avatarCanvas\" \n            />\n        </div>\n        )\n    }\n}\n\nexport default AvatarEdit;\n\nfunction drawRect(context, x, y, w, h, color){\n    context.fillStyle = color;\n    context.beginPath();\n    context.fillRect(x, y, w, h)\n    // context.fill();\n}","import React from \"react\"\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n  } from \"react-router-dom\";\nimport { Canvas } from \"./Canvas\";\nimport LevelEdit from \"./LevelEdit\";\nimport AvatarEdit from \"./AvatarEdit\";\n\nexport default function Routes() {\n    return(\n        <Router>\n            <Switch>\n                <Route path='/edit-avatar'>\n                    <AvatarEdit />\n                </Route>\n                <Route path=\"/edit-map\">\n                    <LevelEdit />\n                </Route>\n                <Route path=\"/\">\n                    <Canvas/>\n                </Route>\n            </Switch>\n        </Router>\n    )\n}\n","import React from 'react';\nimport './App.css';\nimport Routes from './components/Routes';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Routes/>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = \"data:image/png;base64,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\""],"sourceRoot":""}